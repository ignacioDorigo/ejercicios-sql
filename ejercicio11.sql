-- Ejercicio 11 --
-- 11. ¿Quienes son los socios pidieron libros que tuviesen un solo autor? ---- Vamos a tener que Hacer JOins con Prestamos, socios (para saber el nombre del socio) y AutorLibro-- Primero vamos a usar un GROUP BY y COUNT en AutorLibro para agruparlos por isbn, y filtrar los que tengan un solo autorSELECT isbn as libro, COUNT(isbn) as cantidadAutoresFROM AutorLibroGROUP BY isbnHAVING COUNT(isbn) = 1-- Ahora hacemos JOINS entre las tablas que queremosSELECT *FROM (SELECT isbn as isbn, COUNT(isbn) as cantidadAutores	  FROM AutorLibro	  GROUP BY isbn	  HAVING COUNT(isbn) = 1) AS solo1AutorINNER JOIN Prestamos ON Prestamos.isbn = solo1Autor.isbnINNER JOIN Socios ON Socios.codSocio = Prestamos.socio-- Solo queremos el nombre de esas personas (podemos usar DISTINCT para no tener repetidos) --SELECT DISTINCT Socios.nombreFROM (SELECT isbn as isbn, COUNT(isbn) as cantidadAutores	  FROM AutorLibro	  GROUP BY isbn	  HAVING COUNT(isbn) = 1) AS solo1AutorINNER JOIN Prestamos ON Prestamos.isbn = solo1Autor.isbnINNER JOIN Socios ON Socios.codSocio = Prestamos.socio